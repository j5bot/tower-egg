(function(a){"function"==typeof define&&define.amd?define(["jquery","jquery-ui"],a):a(jQuery)})(function(a){var b=".tower-container{position:relative;width:800px;height:280px;background-color:white;border:#3d9952 solid 3px;font-family:Helvetica,Arial,sans-serif;border-radius:20px;z-index:20;user-select:none;-webkit-user-select:none;}.tower-banner{display:none;position:absolute;top:50px;left:200px;height:100px;width:400px;font-size:12px;background-color:#3d9952;color:white;text-align:center;padding:20px;border-radius:20px;border:solid 1px #c6f1a2;z-index:24;}.tower-banner h1{font-size:30px;}.tower-peg{display:inline-block;position:relative;margin:0;padding:0;margin-left:10px;width:250px;height:280px;background-image:-webkit-linear-gradient(left,transparent 52px,#53c66d 52px,#c6f1a2 72px,#53c66d 84px,transparent 88px);background-image:linear-gradient(left,transparent 52px,#53c66d 52px,#c6f1a2 72px,#53c66d 84px,transparent 88px);}.tower-peg-top{height:30px;width:60px;position:absolute;top:0;left:50px;background-color:white;background-image:-webkit-radial-gradient(20px bottom,20px 13px,#c6f1a2 0,#53c66d 88%,rgba(0,0,0,0) 88%);background-image:radial-gradient(20px 13px at 20px bottom,#c6f1a2 0,#53c66d 88%,rgba(0,0,0,0) 88%);}.tower-discs{list-style-type:none;margin:0;padding:0;position:absolute;bottom:0;width:230px;text-align:center;z-index:23;cursor:hand;}.tower-disc{display:block;color:white;font-size:15px;line-height:25px;font-weight:bold;text-shadow:-1px -1px rgba(0,0,0,0.3);background-color:#4bd321;background-image:-webkit-linear-gradient(top,#c6f1a2 22%,#3d9952 88%);background-image:-moz-linear-gradient(top,#c6f1a2 22%,#3d9952 88%);background-image:-ms-linear-gradient(top,#c6f1a2 22%,#3d9952 88%);background-image:-o-linear-gradient(top,#c6f1a2 22%,#3d9952 88%);background-image:linear-gradient(to bottom,#c6f1a2 22%,#3d9952 88%);border:solid 1px #3d9952;border-radius:15px;margin:10px;height:25px;}";a.tower=a.fn.tower=function(c,d){function e(b){function k(){if(a(".tower-disc",f).size()==h)return console.log(c+" / "+i),void 0;c++;var b,d,k=g.offset();b=e.eq(g.parent().parent().data(j?"leftPeg":"rightPeg")),d=b.offset(),d.left=d.left-k.left+g.position().left,g.animate({top:"-100px",left:d.left+"px"},{duration:1e3,complete:m(g,b)})}function l(){if(a(".tower-disc",f).size()==h)return console.log(c+" / "+i),void 0;c++;var b,d,g,j,k=[];e.each(function(){var b=a(".tower-disc:first",this);b.size()>0?k.push(parseInt(b.attr("data-tower-disc-size"),10)):k.push(1/0)});for(var l=0,m=k.length;m>l;l++)for(var o=0,p=k.length;p>o;o++)if(k[l]>1&&k[l]<k[o]){b=a(".tower-disc:first",e.eq(l)),j=b.offset(),d=e.eq(o);break}g=d.offset(),g.left=g.left-j.left+b.position().left,b.animate({top:"-100px",left:g.left+"px"},{duration:1e3,complete:n(b,d)})}function m(b,c){return function(){b.css({top:"",left:""}).prependTo(a(".tower-discs",c)),l()}}function n(b,c){return function(){b.css({top:"",left:""}).prependTo(a(".tower-discs",c)),k()}}for(var c=0,d=a(".tower-disc",b),e=a(".tower-peg",b),f=e.last(),g=d.first(),h=d.size(),i=Math.pow(2,h)-1,j=d.size()%2>0,o=0,p=e.size();p>o;o++)j?e.eq(o).data("leftPeg",0===o?p-1:o-1):e.eq(o).data("rightPeg",o===p-1?0:o+1);k()}function f(b,d){var k,o,p,e=0,f=45,g=110,h=230,i=c.min||3,j=b.size(),l=a('<div class="tower-container" />').append('<div class="tower-peg"><ul class="tower-discs" /><div class="tower-peg-top" /></div>').append('<div class="tower-peg"><ul class="tower-discs" /><div class="tower-peg-top" /></div>').append('<div class="tower-peg"><ul class="tower-discs" /><div class="tower-peg-top" /></div>').append('<div class="tower-banner"><h1>CONGRATULATIONS!</h1><p>Completed in <span class="tower-moves">0</span> moves (your score: <span class="tower-score">0</span>%)</p></div>').appendTo(d),m=a(".tower-peg",l),n=a(".tower-discs",m).first();if(i>j){for(var q=j;i>q;q++)b=b.add("<span>"+(q+1)+"</span>");j=b.size()}return l.add(m).css({height:f*(j+1)+"px"}),k=Math.pow(2,j)-1,p=Math.floor((h-g)/j),b.each(function(b){var c=a(this),d=c.text();d&&0!==d.length||(d=""+(b+1)),a('<li class="tower-disc" data-tower-disc-size="'+(b+1)+'">'+d+"</li>").css({width:g+b*p+"px"}).appendTo(n)}),o=a(".tower-disc"),m.last().addClass("winner"),m.droppable({accept:function(b){var c=a(".tower-disc:first",this).attr("data-tower-disc-size"),d=parseInt(b.attr("data-tower-disc-size"),0);return isNaN(c)||parseInt(c,10)>d?!0:!1},drop:function(b,c){var f,g,d=a(this);c.draggable.css({top:"",left:""}).prependTo(a(".tower-discs",this)).draggable("option","revert",!1),e++,d.hasClass("winner")&&(g=a(".tower-disc",d.parent()).size(),f=a(".tower-disc",d).size(),f===g&&(a(".tower-moves").text(e),a(".tower-score").text(Math.floor(100*(e/k))),a(".tower-banner").show(),o.draggable("disable")))},tolerance:"intersect",scope:"tower"}),o.draggable({cancel:".tower-discs .tower-disc:gt(0)",containment:".tower-container",cursor:"hand",scope:"tower",zIndex:3e3,start:function(){a(this).draggable("option","revert",!0)}}),b}var g=this;return c.source&&(g=a(c.source).children()),0===a("#tower-stylesheet").size()&&a('<style id="tower-stylesheet" />').html(b).appendTo("head"),f(g,a(c.container?c.container:c)),d&&e(a(c.container?c.container:c)),this}});